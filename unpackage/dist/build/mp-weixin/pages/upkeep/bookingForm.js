(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/upkeep/bookingForm"],{"0220":function(e,t,a){},"2c34":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return i}));var i={uDivider:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-divider/u-divider")]).then(a.bind(null,"944a"))},uIcon:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(a.bind(null,"0f14"))},uRadioGroup:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-radio-group/u-radio-group")]).then(a.bind(null,"8f9f"))},uRadio:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-radio/u-radio")]).then(a.bind(null,"37f9"))},uDatetimePicker:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-datetime-picker/u-datetime-picker")]).then(a.bind(null,"8fe1"))},uPicker:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-picker/u-picker")]).then(a.bind(null,"b61f"))}},n=function(){var e=this,t=e.$createElement,a=(e._self._c,e.orderlist.length),i=a>0&&1==e.formData.isupkeepmeal?e.__map(e.orderlist,(function(t,a){var i=e.__get_orig(t),n=e.getincludes(t);return{$orig:i,m0:n}})):null,n=a>0?null:0==e.orderlist.length&&e.meallist.length;e._isMounted||(e.e0=function(t){e.showarrivalDate=!1},e.e1=function(t){e.showarrivalTime=!1}),e.$mp.data=Object.assign({},{$root:{g0:a,l0:i,g1:n}})},r=[]},"2d9e":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;a("04ff");var i={data:function(){return{columns:[],mycarobj:null,mySale:{},formData:{deliveryCarService:0,replaceCarService:0,managerId:"",arrivalDate:"",arrivalTime:"",iskeep:0,isupkeepmeal:1,mealid:[]},radiolist:[{name:"需要",value:1},{name:"不需要",value:0}],upkeepmeallist:[{name:"是",value:1},{name:"否",value:0}],deliveryCarService:"不需要",replaceCarService:"不需要",isupkeepmeal:"是",managerId:"",shopId:"",codeurl:"",brandId:"",showarrivalDate:!1,todaydate:"",showarrivalTime:!1,orderlist:[],meallist:[],shopdetail:{},isrepeat:!0}},onLoad:function(t){var a=this;t.brandId&&(this.brandId=t.brandId),this.shopId=t.shopId,e.$on("refresh",(function(e){a.mycarobj=e})),this.getshopdetail();var i=new Date,n=new Date(i);n.setDate(i.getDate()+1),this.formData.arrivalDate=n.getFullYear()+"-"+Number(n.getMonth()+1)+"-"+n.getDate(),this.todaydate=i.getTime()},onShow:function(){this.getorderList(),this.getDetail()},methods:{getincludes:function(e){return this.formData.mealid.includes(e.orderId)},getcar:function(){var e=this;this.$request.post("/coc-my/api/v1/my/user/car/lists/v2",{brandId:Number(this.brandId)}).then((function(t){e.mycarobj=t.data[0]}))},togo:function(){var t=this;if(!this.formData.arrivalTime)return e.$u.toast("请选择您的到店时间"),!1;if(!this.mycarobj)return e.$u.toast("请选择您的爱车"),!1;if(!this.isrepeat)return!1;this.isrepeat=!1;var a="";this.formData.mealid&&(a=this.formData.mealid.join(",")),this.$request.post("/coc-active/api/v1/maintenance_appointment/save",{arrivalDate:this.formData.arrivalDate,arrivalTime:this.formData.arrivalTime,brandId:this.brandId,plate:this.mycarobj.plate,vehicleName:this.mycarobj.vehicleName,customerManagerId:this.mySale.customerManagerId,shopId:this.shopId,pickUpService:this.formData.iskeep,replacementCarService:this.formData.replaceCarService,maintainMealOrderId:a}).then((function(a){200==a.code?e.redirectTo({url:"/pages/upkeep/reservationend?shopId="+t.shopId+"&status=1"}):e.$u.toast(a.message)}))},OnPushDetail:function(t){e.navigateTo({url:"/pages/carShops/upkeep/detail?id="+t.id+"&isform=1"})},getshopdetail:function(){var e=this;this.$request.get("/coc-active/api/v1/four_s/shopDetails/"+this.shopId).then((function(t){e.brandId=t.data.brandId,e.shopdetail=t.data,e.getcar()}))},Onchoosemeal:function(e){this.formData.mealid.includes(e)?this.formData.mealid=this.formData.mealid.filter((function(t){return t!==e})):this.formData.mealid.push(e)},getmeallist:function(){var e=this;this.$request.post("/coc-active/api/v1/four_s/maintain_meal/list",{shopId:this.shopId}).then((function(t){e.meallist=t.data.maintainMealListVOS}))},getorderList:function(){var e=this;this.$request.post("/coc-active/api/v2/maintain_meal/orderList",{shopId:this.shopId,current:1,size:99,status:1,isSelect:0}).then((function(t){0==t.data.total?e.getmeallist():e.orderlist=t.data.records}))},getTodayFormatted:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate();return a=a<10?"0"+a:a,i=i<10?"0"+i:i,t+"-"+a+"-"+i},customFormat:function(e){var t=("0"+e.getHours()).slice(-2)+":00";return t},OnchangearrivalTime:function(){var e=this.getTodayFormatted();if(e==this.formData.arrivalDate){this.columns=[];for(var t=new Date,a=t.getHours()+1;a<=16;a++){var i=new Date;i.setHours(a),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0);var n=new Date;n.setHours(a+1),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),i=this.customFormat(i),n=this.customFormat(n),this.columns.push(i+" - "+n),console.log("获取今天时间",this.columns)}this.columns=[this.columns]}else this.columns=[["08:00-09:00","09:00-10:00","10:00-11:00","11:00-12:00","12:00-13:00","13:00-14:00","14:00-15:00","15:00-16:00","16:00-17:00"]];this.showarrivalTime=!0},OnarrivalTime:function(e){this.formData.arrivalTime=e.value[0],this.showarrivalTime=!1},OnarrivalDate:function(e){this.formData.arrivalTime="";var t=e.value,a=new Date(t),i=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,n=a.getDate()<10?"0"+a.getDate():a.getDate();a.getHours(),a.getHours(),a.getMinutes(),a.getMinutes();this.formData.arrivalDate=a.getFullYear()+"-"+i+"-"+n,this.showarrivalDate=!1},OnchangearrivalDate:function(){this.showarrivalDate=!0},OnpushMycar:function(){e.navigateTo({url:"/pages/my/mycar/index?isupkeep=1&brandId="+this.brandId})},getDetail:function(){var e=this,t={shopId:this.shopId};this.$request.post("/coc-active/api/v2/maintain_meal/shop/customerManager/list",t).then((function(t){1==t.data.length?(e.mySale=t.data[0],e.formData.managerId=t.data[0].customerManagerId):e.mySale={}}))},checkSale:function(){e.navigateTo({url:"/pages/carShops/upkeep/checkSales?shopId="+this.shopId})},upleepchange:function(e){"是"==e?this.formData.isupkeepmeal=1:(this.formData.isupkeepmeal=0,this.formData.mealid=[])},groupChange:function(e){this.formData.iskeep="需要"==e?1:0},carChange:function(e){this.formData.replaceCarService="需要"==e?1:0},OnTell:function(){this.mySale.phone?e.makePhoneCall({phoneNumber:this.mySale.phone}):e.showToast({icon:"none",title:"暂无联系方式"})}}};t.default=i}).call(this,a("543d")["default"])},"428f":function(e,t,a){"use strict";(function(e,t){var i=a("4ea4");a("76b1");i(a("66fd"));var n=i(a("9c77"));e.__webpack_require_UNI_MP_PLUGIN__=a,t(n.default)}).call(this,a("bc2e")["default"],a("543d")["createPage"])},"4b75":function(e,t,a){"use strict";a.r(t);var i=a("2d9e"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(r);t["default"]=n.a},"698a":function(e,t,a){"use strict";var i=a("0220"),n=a.n(i);n.a},"9c77":function(e,t,a){"use strict";a.r(t);var i=a("2c34"),n=a("4b75");for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);a("698a");var o=a("f0c5"),s=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"7cea2bbe",null,!1,i["a"],void 0);t["default"]=s.exports}},[["428f","common/runtime","common/vendor"]]]);