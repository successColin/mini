require('./common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/Settlein/uploadEnterprise"],{"08a8":function(t,e,a){"use strict";var i=a("d7e5"),n=a.n(i);n.a},1934:function(t,e,a){"use strict";(function(t){var i=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(a("2eee")),o=i(a("c973")),s=i(a("9523")),r=a("b1ac");function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}var c={components:{ACompress:function(){Promise.all([a.e("common/vendor"),a.e("pages/Settlein/common/vendor"),a.e("pages/Settlein/components/ACompress")]).then(function(){return resolve(a("57f8"))}.bind(null,a)).catch(a.oe)}},data:function(){return{option:{},identityDisabled:!1,identityArr:[{name:"我是法人",value:1},{name:"我不是法人",value:2}],currentmcc:0,showloading:!1,type:"",base64:"",isshow:!0,mccshow:!1,industrylist:[],qualificationsList:[],qualificationsImg:[],identity:1,dataList:{settleType:"",qualificationsImg:[],mccCode:"",mccMsg:"",bankImgFront:"",bankImgBack:"",selfieImg:"",licenceOpening:"",indoorPhotograph:"",doorheadPhoto:"",appScreenshot:"",bnfHomeAddr:"",bnfCertExpire:"",bnfCertno:"",bnfName:"",companyAddrExt:"",companyCertExpire:"9999-12-31",shareholderHomeAddr:"",shareholderCertExpire:"",shareholderCertno:"",shareholderName:"",companyName:"",companyCertNo:"",legalmanHomeAddr:"",legalIdcardNo:"",legalName:"",juridicalIdCardFrontImg:"",juridicalIdCardBackImg:"",licenseImg:"",picList:[],legalCardDeadline:"",screenshotImg:"",fundManagementConfirmationLetterImg:"",cashierImg:"",feeConfirmationLetterImg:"",agentIdCardFrontImg:"",agentIdCardBackImg:"",agentPowerOfAttorneyImg:"",regMerType:"00",bankAcctType:"1",shareHolderType:"1",bnfType:"1",bnfList:[{bnfName:"",bnfCertno:"",bnfCertExpire:"",bnfCertType:"1",bnfHomeAddr:""}]}}},onLoad:function(e){this.option=e,this.type=e.type,1==e.isshow?(this.isshow=!1,t.setNavigationBarTitle({title:"企业入驻资料查看"}),this.getList("1")):2==e.isshow?this.getList("4"):this.getList("4","/coc-merchant-app/app/v1/merchantsettledin/viewSave"),e.sourceType&&(this.dataList.sourceType=e.sourceType),e.operateId&&(this.dataList.operateId=e.operateId),e.operateId&&(this.dataList.operateId=e.operateId),e.affiliationType&&(this.dataList.affiliationType=e.affiliationType),e.isLineLedger&&(this.dataList.isLineLedger=e.isLineLedger),e.settleType&&(this.dataList.settleType=e.settleType),console.log(e)},onShow:function(){},methods:{groupChange:function(t){this.identity=t,1==t&&(this.dataList.agentIdCardFrontImg="",this.dataList.agentIdCardBackImg="",this.dataList.agentPowerOfAttorneyImg="")},Onchoosemcc:function(t){this.mccshow=!1,this.dataList.mccCode=t.mccCode,this.dataList.mccMsg=t.mccMsg,this.qualificationsList=t.qualificationsList,this.qualificationsImg=[]},OnMccCode:function(){var t=this;this.$request.post("/coc-merchant-app/app/v1/merchantsettledin/selectIndustry").then((function(e){t.industrylist=e.data,t.mccshow=!0}))},getList:function(e,a){var i=this,n=a||"/coc-active/api/v1/merchantsettledin/dataEcho",o={};o=a?{mobile:t.getStorageSync("mobile")}:{echoType:e},this.$request.post(n,o).then((function(t){var n="";"1"===e?n=t.data.settlementMaterials:"4"===e&&(n=a?t.data:t.data.merchansettledinDTO,i.dataList.bnfList=[]);var o=n,s=o.licenseImg,r=o.juridicalIdCardFrontImg,d=o.juridicalIdCardBackImg,c=o.appScreenshot,l=o.licenceOpening,u=o.doorheadPhoto,m=o.indoorPhotograph,p=o.fundManagementConfirmationLetterImg,h=o.feeConfirmationLetterImg,g=o.cashierImg,f=o.agentIdCardFrontImg,L=o.agentIdCardBackImg,I=o.agentPowerOfAttorneyImg,y=o.industryMsg,b=o.qualificationsImg,v=o.indoorPhotograph2,P=o.settleType,_=o.mccMsg,w=o.isLineLedger;i.dataList=n,i.dataList.licenseImg=s,i.dataList.juridicalIdCardFrontImg=r,i.dataList.juridicalIdCardBackImg=d,i.dataList.screenshotImg=c,i.dataList.licenceOpening=l,i.dataList.DoorheadImg=u,i.dataList.cashierImg=g,i.dataList.indoorPhotograph=m,i.dataList.fundManagementConfirmationLetterImg=p,i.dataList.feeConfirmationLetterImg=h,i.dataList.agentIdCardFrontImg=f,i.dataList.agentIdCardBackImg=L,i.dataList.agentPowerOfAttorneyImg=I,i.indoorPhotograph2=v,i.dataList.isLineLedger=w,i.dataList.settleType=P,i.option.settleType&&(i.dataList.settleType=i.option.settleType),i.option.isLineLedger&&(i.dataList.isLineLedger=i.option.isLineLedger),"1"===e?(i.dataList.IndoorImg=u,i.dataList.mccMsg=y,i.dataList.licenceOpening=t.data.featuredMaterials.licenceOpening):"4"===e&&(i.dataList.IndoorImg=m,i.dataList.mccMsg=_,i.dataList.bnfList=[]),console.log(f,L,I),i.identity=f&&L&&I?2:1,i.qualificationsImg=b.split(","),i.qualificationsList=b.split(","),i.isshow||(i.identityDisabled=!0)}))},Submit:function(){var e=this,a=!0;2===this.identity&&(a=!1,this.dataList.agentIdCardFrontImg&&this.dataList.agentIdCardBackImg&&this.dataList.agentPowerOfAttorneyImg&&(a=!0));var i=!0;2==this.dataList.settleType&&(i=!1,this.dataList.fundManagementConfirmationLetterImg&&this.dataList.feeConfirmationLetterImg&&this.dataList.cashierImg&&this.dataList.indoorPhotograph&&(i=!0));var n=!0;if(1==this.dataList.settleType&&(n=!1,this.dataList.indoorPhotograph&&this.dataList.indoorPhotograph2&&(n=!0)),console.log(this.dataList,this.dataList.isLineLedger,a,i,n),this.dataList.juridicalIdCardFrontImg&&this.dataList.juridicalIdCardBackImg&&this.dataList.licenseImg&&this.dataList.DoorheadImg&&this.dataList.licenceOpening&&this.dataList.doorheadPhoto&&this.dataList.mccCode&&a&&i&&n){var o=0;if(this.qualificationsImg.filter((function(t){t&&o++})),o!=this.qualificationsList.length)return this.$refs.uToast.show({type:"default",message:"请上传特殊资质图片"}),!1;this.qualificationsImg&&(this.dataList.qualificationsImg=this.qualificationsImg.join(",")),this.dataList.picList.filter((function(t){"0001"==t.document_type?t.document_name="法人身份证":"0011"==t.document_type?t.document_name="身份证反面":"0002"==t.document_type?t.document_name="商户营业执照":"0034"==t.document_type?t.document_name="商户网站/APP截图":"0005"==t.document_type?t.document_name="门头照片":"0015"==t.document_type?t.document_name="室内照片":"0006"==t.document_type&&(t.document_name="开户许可证")})),this.dataList.regMerType="00",this.dataList.bankAcctType="1",this.dataList.shareHolderType="1",this.dataList.bnfType="1";var r=JSON.parse(JSON.stringify(this.dataList));delete r.isLineLedger,delete r.settleType,this.$request.post("/coc-merchant-app/app/v1/merchantsettledin/preservation",function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(Object(a),!0).forEach((function(e){(0,s.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({mobile:t.getStorageSync("mobile")},r)),console.log(this.dataList),t.navigateTo({url:"/pages/Settlein/enterpriseInfo?identity=".concat(this.identity,"&settleType=").concat(this.dataList.settleType),success:function(t){t.eventChannel.emit("getinfo",{data:e.dataList})}})}else this.$refs.uToast.show({type:"default",message:"请上传企业入驻资料"})},uploadPictures:function(e,a){var i=this,n=!1,o=this;this.$newrequest.post("/coc-active/api/v1/merchantsettledin/uploadPictures",{img:e}).then((function(e){o.showloading=!1,200==e.code?(i.dataList.picList.filter((function(t,o){t.document_type==a&&(n=!0,i.dataList.picList[o]={document_type:a,file_path:e.data.filePath,file_size:e.data.fileSize})})),n||i.dataList.picList.push({document_type:a,file_path:e.data.filePath,file_size:e.data.fileSize})):t.$u.toast(e.message)}))},getbase64:function(t,e){var a=this;(0,r.pathToBase64)(t).then((function(t){a.uploadPictures(t,e)})).catch((function(t){console.error(t)}))},Onspecialimg:function(e){var a=this;t.chooseImage({count:1,sizeType:["original","compressed"],success:function(t){a.uploadimg(t.tempFilePaths[0],e)}})},OnDoorhead:function(){var e=this;t.chooseImage({count:1,sizeType:["original","compressed"],success:function(t){e.showloading=!1,e.dataList.DoorheadImg=t.tempFilePaths[0],e.uploadimg(t.tempFilePaths[0],"doorheadPhoto"),1==e.dataList.settleType&&e.getbase64(t.tempFilePaths[0],"0005")}})},Onscreenshot:function(){var e=this;t.chooseImage({count:1,sizeType:["original","compressed"],success:function(t){e.showloading=!1,e.dataList.screenshotImg=t.tempFilePaths[0],e.uploadimg(t.tempFilePaths[0],"appScreenshot"),1==e.dataList.settleType&&e.getbase64(t.tempFilePaths[0],"0034")}})},handleUpload:function(e){var a=this;t.chooseImage({count:1,sizeType:["original","compressed"],success:function(t){a.uploadimg(t.tempFilePaths[0],e),"indoorPhotograph"===e&&a.getbase64(t.tempFilePaths[0],"0015"),"licenceOpening"===e&&a.getbase64(t.tempFilePaths[0],"0006")}})},uploadimg:function(e,a){var i=this,n=this;this.$refs.compress.start(e).then((function(o){e=o,i.showloading=!0,t.uploadFile({url:getApp().globalData.uploadUrl,filePath:e,name:"file",formData:{file:e},header:{"Content-Type":"multipart/form-data"},success:function(t){n.showloading=!1,console.log(11111111,JSON.parse(t.data).data),n.dataList[a]=JSON.parse(t.data).data,n.qualificationsImg[a]=JSON.parse(t.data).data}})})).catch((function(){t.$u.toast("图片压缩失败"),i.showloading=!1}))},CardlicenseImg:function(e){var a=this;return(0,o.default)(n.default.mark((function i(){var o,s,r,d;return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e||a.$refs.uToast.show({type:"default",message:"照片模糊"}),20==e.detail.reg_num.text.length?a.dataList.shopLic=e.detail.reg_num.text.substring(0,18):17==e.detail.reg_num.text.length?a.dataList.shopLic=e.detail.reg_num.text.substring(0,15):a.dataList.shopLic=e.detail.reg_num.text,a.dataList.shopName=e.detail.enterprise_name.text,a.dataList.shopAddrExt=e.detail.address.text,o=a,a.showloading=!0,i.next=8,a.$newrequest.post("/coc-active/api/v1/merchantsettledin/isRepeat",{shopName:a.dataList.shopName});case 8:if(s=i.sent,r=s.code,d=s.message,200===r){i.next=15;break}return t.$u.toast(d),a.showloading=!1,i.abrupt("return");case 15:console.log("============111111111"),t.uploadFile({url:getApp().globalData.uploadUrl,filePath:e.detail.image_path,name:"file",formData:{file:e.detail.image_path},header:{"Content-Type":"multipart/form-data"},success:function(t){o.showloading=!1,console.log("============222222222"),o.dataList.licenseImg=JSON.parse(t.data).data,1==o.dataList.settleType&&o.getbase64(e.detail.image_path,"0002")}});case 17:case"end":return i.stop()}}),i)})))()},CardBackImg:function(e){var a=e.detail.valid_date.text.substr(e.detail.valid_date.text.lastIndexOf("-")+1,8);a=a.slice(0,4)+"-"+a.slice(4),a=a.slice(0,7)+"-"+a.slice(7),this.dataList.legalCardDeadline=a;var i=this;this.showloading=!0,t.uploadFile({url:getApp().globalData.uploadUrl,filePath:e.detail.image_path,name:"file",formData:{file:e.detail.image_path},header:{"Content-Type":"multipart/form-data"},success:function(t){i.showloading=!1,i.dataList.juridicalIdCardBackImg=JSON.parse(t.data).data,1==i.dataList.settleType&&i.getbase64(e.detail.image_path,"0011")}})},CardFrontImg:function(e){this.dataList.legalName=e.detail.name.text,this.dataList.legalIdcardNo=e.detail.id.text,this.dataList.legalmanHomeAddr=e.detail.address.text;var a=this;this.showloading=!0,t.uploadFile({url:getApp().globalData.uploadUrl,filePath:e.detail.image_path,name:"file",formData:{file:e.detail.image_path},header:{"Content-Type":"multipart/form-data"},success:function(t){a.showloading=!1,a.dataList.juridicalIdCardFrontImg=JSON.parse(t.data).data,1==a.dataList.settleType&&a.getbase64(e.detail.image_path,"0001")}})}}};e.default=c}).call(this,a("543d")["default"])},"3b7e":function(t,e,a){"use strict";a.r(e);var i=a("1934"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},"6d2f":function(t,e,a){"use strict";var i=a("ac6f"),n=a.n(i);n.a},"800c":function(t,e,a){"use strict";a.r(e);var i=a("f10f"),n=a("3b7e");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("08a8"),a("6d2f");var s=a("f0c5"),r=Object(s["a"])(n["default"],i["b"],i["c"],!1,null,"b9bd1a26",null,!1,i["a"],void 0);e["default"]=r.exports},ac6f:function(t,e,a){},d7e5:function(t,e,a){},f10f:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i}));var i={uForm:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-form/u-form")]).then(a.bind(null,"cf22"))},uFormItem:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-form-item/u-form-item")]).then(a.bind(null,"ee1b"))},"u-Input":function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u--input/u--input")]).then(a.bind(null,"c00c"))},uRadioGroup:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-radio-group/u-radio-group")]).then(a.bind(null,"8f9f"))},uRadio:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-radio/u-radio")]).then(a.bind(null,"37f9"))},uToast:function(){return a.e("uni_modules/uview-ui/components/u-toast/u-toast").then(a.bind(null,"1b13"))},uLoadingPage:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-loading-page/u-loading-page")]).then(a.bind(null,"e325"))},uPopup:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(a.bind(null,"8add"))},uIcon:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(a.bind(null,"0f14"))}},n=function(){var t=this,e=t.$createElement,a=(t._self._c,t.qualificationsList.length);t._isMounted||(t.e0=function(e){t.mccshow=!1},t.e1=function(e,a){var i=arguments[arguments.length-1].currentTarget.dataset,n=i.eventParams||i["event-params"];a=n.index;t.currentmcc=a}),t.$mp.data=Object.assign({},{$root:{g0:a}})},o=[]},f2b3:function(t,e,a){"use strict";(function(t,e){var i=a("4ea4");a("76b1");i(a("66fd"));var n=i(a("800c"));t.__webpack_require_UNI_MP_PLUGIN__=a,e(n.default)}).call(this,a("bc2e")["default"],a("543d")["createPage"])}},[["f2b3","common/runtime","common/vendor","pages/Settlein/common/vendor"]]]);