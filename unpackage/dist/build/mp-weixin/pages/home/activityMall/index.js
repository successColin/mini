(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/activityMall/index"],{"1cf9":function(t,e,i){"use strict";(function(t,e){var s=i("4ea4");i("4319");s(i("66fd"));var n=s(i("5309"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(n.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},"2fe5":function(t,e,i){"use strict";var s=i("a687"),n=i.n(s);n.a},"3fea":function(t,e,i){"use strict";(function(t){var s=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(i("2eee")),o=s(i("c973")),r={components:{carousel:function(){Promise.all([i.e("common/vendor"),i.e("components/carousel/index")]).then(function(){return resolve(i("c969"))}.bind(null,i)).catch(i.oe)}},computed:{navbarHeight:function(){return t.getStorageSync("menuInfo")?t.getStorageSync("menuInfo").contentTop:0}},data:function(){return{paybtn:"支付优惠",typebtn:"商家类型",classbtn:"商家分类",sortbtn:"商家排序",property:0,indoor:0,groupstore:0,outdoors:0,categoryList:[],otherSearchVisble:!1,index:null,sortList:[{id:1,name:"默认"},{id:2,name:"离我最近"}],sponsorList:[{id:0,name:"全部"},{id:1,name:"活动商家"},{id:2,name:"团购商家"}],paymentDiscountList:[],oldSearchField:{shopTypeId:"",shopTypeName:"",activityPaymentPreferenceId:"",activityPaymentPreferenceName:"",shopCategoryId:"",shopCategoryName:""},searchField:{current:1,sort:1,shopTypeId:"",shopTypeName:"",activityPaymentPreferenceId:"",activityPaymentPreferenceName:"",shopCategoryId:"",shopCategoryName:"",lng:"",lat:"",shopName:"",size:100},topDataList:[],dataList:[],showArrondi:!1,payType:0,shopType:0,sort:1,payTypepop:null,shopTypepop:null,businessTypeindex:0,sortpop:1,current:1,isLoadMore:!1,sortindex:1,shopTypeindex:0,payTypeindex:0,shopCategoryId:0,keyword:"",visitinto:null}},onReachBottom:function(){this.isLoadMore||(this.current++,this.getList())},onHide:function(){t.getStorageSync("token")&&this.$request.post("/coc-active/api/v1/user/behavior/visit_exit",{userVisitId:this.visitinto}).then((function(t){}))},onUnload:function(){t.getStorageSync("token")&&this.$request.post("/coc-active/api/v1/user/behavior/visit_exit",{userVisitId:this.visitinto}).then((function(t){}))},onLoad:function(e){e.lat&&t.setStorageSync("lat",e.lat),e.lng&&t.setStorageSync("lng",e.lng),this.getCategoryList(),this.getPaymentPreferenceList(),this.getList()},onShow:function(){var e=this;t.getStorageSync("token")&&this.$request.post("/coc-active/api/v1/user/behavior/visit_into",{type:4}).then((function(t){e.visitinto=t}))},methods:{Ontype:function(t){console.log("商家类型",t),this.current=1,this.shopTypeindex=t.id,this.shopType=t.id,this.getList(),0==t.id?this.typebtn="商家类型":this.typebtn=t.name,this.otherSearchVisble=!1},Onpay:function(t){this.current=1,this.payTypeindex=t.id,this.payType=t.id,this.getList(),0==t.id?this.paybtn="商家优惠":this.paybtn=t.name,this.otherSearchVisble=!1},Onclass:function(t){this.current=1,this.businessTypeindex=t.id,this.shopCategoryId=t.id,this.getList(),0==t.id?this.classbtn="商家分类":this.classbtn=t.name,this.otherSearchVisble=!1},Onsort:function(t){this.current=1,this.sortindex=t.id,this.sort=t.id,this.getList(),1==t.id?this.sortbtn="商家排序":this.sortbtn=t.name,this.otherSearchVisble=!1},Onchangeindex:function(t){this.index=t},OnClickIngroup:function(t){0==t?(this.outdoors=0,this.indoor=0,this.groupstore=0,this.property=0):(this.outdoors=0,this.indoor=0,this.groupstore=t,this.property=3),this.classbtn="商家分类",this.businessTypeindex=0,this.shopCategoryId=0,this.current=1,this.getCategoryList(),this.getList()},OnClickInDoors:function(t){0==t?(this.outdoors=0,this.indoor=0,this.property=0,this.groupstore=0):(this.groupstore=0,this.outdoors=0,this.indoor=t,this.property=2),this.classbtn="商家分类",this.businessTypeindex=0,this.shopCategoryId=0,this.current=1,this.getCategoryList(),this.getList()},OnClickOutDoors:function(t){0==t?(this.groupstore=0,this.outdoors=0,this.indoor=0,this.property=0):(this.groupstore=0,this.outdoors=t,this.indoor=0,this.property=1),this.classbtn="商家分类",this.businessTypeindex=0,this.shopCategoryId=0,this.current=1,this.getCategoryList(),this.getList()},OnPush:function(e){t.navigateTo({url:"/pages/activityMall/business/index?id="+e.id+"&shopType="+this.shopType})},nextList:function(){this.isLoadMore||(this.current++,this.getList())},tosearch:function(){this.isLoadMore=!1,this.current=1,this.getList()},getList:function(){var t=this;this.$newrequest.post("/coc-active/api/v2/homePage/getActivityShopNew",{property:this.property,current:this.current,payType:this.payType,shopType:this.shopType,size:10,sort:this.sort,shopCategoryId:this.shopCategoryId,name:this.keyword}).then((function(e){e.data.records.filter((function(t){t.imglist=[],t.imgs.filter((function(e){e.associatedContent.split(",").filter((function(e){t.imglist.push(e)}))}))})),e.data.records.length<10&&(t.isLoadMore=!0),1==e.data.current?t.dataList=e.data.records:e.data.records.filter((function(e){t.dataList.push(e)}))}))},getPaymentPreferenceList:function(){var e=this,i=[{id:0,name:"全部"}];this.$newrequest.post("/coc-active/api/v1/activityShop/list").then(function(){var s=(0,o.default)(n.default.mark((function s(o){return n.default.wrap((function(s){while(1)switch(s.prev=s.next){case 0:200==o.code?(i=i.concat(o.data),e.paymentDiscountList=i):t.showToast({title:o.message,icon:"none",duration:2e3});case 1:case"end":return s.stop()}}),s)})));return function(t){return s.apply(this,arguments)}}())},getCategoryList:function(){var e=this;this.$newrequest.post("/coc-active/api/v1/activityShop/categoryList",{property:this.property,current:1,size:100}).then(function(){var i=(0,o.default)(n.default.mark((function i(s){return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:200==s.code?(e.categoryList=s.data.records&&s.data.records.length>0?s.data.records:[],e.categoryList.unshift({id:0,name:"全部"})):t.showToast({title:s.message,icon:"none",duration:2e3});case 1:case"end":return i.stop()}}),i)})));return function(t){return i.apply(this,arguments)}}())},OnPushView:function(e){1==e?t.navigateTo({url:"/pages/activity/activityRegistration/bankactivity?shopTypeId=1&activityPaymentPreferenceId=6"}):2==e?t.navigateTo({url:"/pages/activity/activityRegistration/bankactivity?shopTypeId=2&activityPaymentPreferenceId=5"}):3==e?t.navigateTo({url:"/pages/activity/activityRegistration/bankactivity?shopTypeId=3&activityPaymentPreferenceId=4"}):4==e&&t.navigateTo({url:"/pages/activity/activityRegistration/foursactivity?"})},getHomeBusinessList:function(e){var i=this,s=this.changeSearchField();e&&(s.size=e),this.$newrequest.post("/coc-active/api/v1/activityShop/signUpIn/list",s).then(function(){var e=(0,o.default)(n.default.mark((function e(s){var o;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:200==s.code?(o=s.data,o.forEach((function(t){t.baseHead=t.baseHead?t.baseHead:"https://oss.dcqcjlb.com/51che_java_dev/20221031/96f3cd701da641ddb4c43e4349054230.jpg"})),i.topDataList=o,i.closeSearch()):t.showToast({title:s.message,icon:"none",duration:2e3});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},changeSearchField:function(){var t=Object.assign({},this.searchField);return t.activityPaymentPreferenceId||delete t["activityPaymentPreferenceId"],t.shopCategoryId||delete t["shopCategoryId"],t.shopTypeId||delete t["shopTypeId"],t.shopName||delete t["shopName"],t.lng||delete t["lng"],t.lat||delete t["lat"],delete t["activityPaymentPreferenceName"],delete t["shopCategoryName"],delete t["shopTypeName"],t},openSearch:function(t){this.index=t,this.oldSearchField.activityPaymentPreferenceId=this.searchField.activityPaymentPreferenceId,this.oldSearchField.activityPaymentPreferenceName=this.searchField.activityPaymentPreferenceName,this.oldSearchField.shopTypeId=this.searchField.shopTypeId,this.oldSearchField.shopTypeName=this.searchField.shopTypeName,this.otherSearchVisble=!0},closeSearch:function(){this.oldSearchField.activityPaymentPreferenceId="",this.oldSearchField.activityPaymentPreferenceName="",this.oldSearchField.shopTypeId="",this.oldSearchField.shopTypeName="",this.oldSearchField.shopCategoryId="",this.oldSearchField.shopCategoryName="",this.otherSearchVisble=!1},confirmSearch:function(t){this.sort=this.sortpop,this.shopType=this.shopTypepop,this.payType=this.payTypepop,this.shopCategoryId=this.shopCategoryId,this.current=1,this.getList(),this.otherSearchVisble=!1},jumpCategory:function(e){t.navigateTo({url:"/pages/activity/grouppuchaselist?shopCategoryId="+e.id})}}};e.default=r}).call(this,i("543d")["default"])},5309:function(t,e,i){"use strict";i.r(e);var s=i("f2e6"),n=i("76db");for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);i("2fe5");var r=i("f0c5"),a=Object(r["a"])(n["default"],s["b"],s["c"],!1,null,"ca423104",null,!1,s["a"],void 0);e["default"]=a.exports},"76db":function(t,e,i){"use strict";i.r(e);var s=i("3fea"),n=i.n(s);for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);e["default"]=n.a},a687:function(t,e,i){},f2e6:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return s}));var s={uSearch:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-search/u-search")]).then(i.bind(null,"ea79"))},uRate:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-rate/u-rate")]).then(i.bind(null,"2b73"))},uIcon:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(i.bind(null,"f23e"))},uPopup:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(i.bind(null,"076f"))}},n=function(){var t=this.$createElement;this._self._c},o=[]}},[["1cf9","common/runtime","common/vendor"]]]);