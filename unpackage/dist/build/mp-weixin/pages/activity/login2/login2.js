(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/activity/login2/login2"],{"0654":function(e,t,o){"use strict";o.r(t);var s=o("78de"),n=o.n(s);for(var a in s)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return s[e]}))}(a);t["default"]=n.a},"3b6a":function(e,t,o){"use strict";o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return s}));var s={uToast:function(){return o.e("uni_modules/uview-ui/components/u-toast/u-toast").then(o.bind(null,"1b13"))}},n=function(){var e=this.$createElement;this._self._c},a=[]},4394:function(e,t,o){},"78de":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=o("04ff"),n={components:{},data:function(){return{showBubble:!1,isAgree:!1,phoneCode:"",inviteId:""}},onLoad:function(t){t.scene&&(this.inviteId=t.scene),(0,s.getstorage)("token")&&this.$request.post("/coc-active/api/v1/user/channel/scan/log",{userChannelId:t.scene,userId:(0,s.getstorage)("userId")}).then((function(t){e.switchTab({url:"/pages/home/index"})}))},onShow:function(){},methods:{getinfo:function(){this.$request.get("/coc-my/api/v1/my/findUser").then((function(e){(0,s.setstorage)("headImg",e.data.user.headImg),(0,s.setstorage)("nickname",e.data.user.nickname),(0,s.setstorage)("userType",e.data.user.userType),(0,s.setstorage)("userId",e.data.user.id),(0,s.setstorage)("isCertify",e.data.user.isCertify),(0,s.setstorage)("realName",e.data.user.realName),(0,s.setstorage)("mobile",e.data.user.mobile),null==e.data.shop?((0,s.setstorage)("status",null),(0,s.setstorage)("shopId",null),(0,s.setstorage)("shopName",null),(0,s.setstorage)("shopTypeId",0),(0,s.setstorage)("shopType",null)):((0,s.setstorage)("status",e.data.shop.status),(0,s.setstorage)("shopId",e.data.shop.id),(0,s.setstorage)("shopName",e.data.shop.shopName),(0,s.setstorage)("shopTypeId",e.data.shop.shopTypeId),(0,s.setstorage)("shopType",e.data.shop.status))}))},loginNow:function(t,o,n,a){var i=this,u=this;e.request({url:"http://coc.51api.dcqcjlb.com/coc-oauth/oauth/token",method:"POST",data:{phoneCode:t,openCode:o,grant_type:"canal",userChannelId:this.inviteId+""},header:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic Y29jLWFwcDoxMjM0NTY="},success:function(t){200==t.data.code&&i.$refs.uToast.show({message:"登录成功",type:"success",complete:function(){(0,s.setstorage)("openid",t.data.data.openid),e.setStorage({key:"token",data:t.data.data.access_token,success:function(){u.getinfo(),e.switchTab({url:"/pages/home/index"})}})}})},fail:function(t){e.showToast({title:t.msg,icon:"none",duration:2e3})}})},getopencode:function(t){var o=this;e.login({provider:"weixin",onlyAuthorize:!0,success:function(e){o.openCode=e.code,o.loginNow(t,e.code,"","")}})},getPhoneNumber:function(e){if(!this.isAgree)return this.showBubble=!0,!1;this.phoneCode=e.detail.code,this.getopencode(e.detail.code)},checkboxChange:function(e){this.isAgree=!this.isAgree,this.isAgree&&(this.showBubble=!1)},OnPushUserAgreement:function(){e.navigateTo({url:"/pages/agreement/webview?url=https://h5.dcqcjlb.com/protocol/user_service.html"})},OnPushPrivacyPolicy:function(){e.navigateTo({url:"/pages/agreement/webview?url=https://h5.dcqcjlb.com/protocol/user_privacy.html"})}}};t.default=n}).call(this,o("543d")["default"])},"7ea5":function(e,t,o){"use strict";o.r(t);var s=o("3b6a"),n=o("0654");for(var a in n)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return n[e]}))}(a);o("e199");var i=o("f0c5"),u=Object(i["a"])(n["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],void 0);t["default"]=u.exports},c652:function(e,t,o){"use strict";(function(e,t){var s=o("4ea4");o("76b1");s(o("66fd"));var n=s(o("7ea5"));e.__webpack_require_UNI_MP_PLUGIN__=o,t(n.default)}).call(this,o("bc2e")["default"],o("543d")["createPage"])},e199:function(e,t,o){"use strict";var s=o("4394"),n=o.n(s);n.a}},[["c652","common/runtime","common/vendor"]]]);