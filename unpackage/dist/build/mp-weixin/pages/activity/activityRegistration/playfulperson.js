(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/activity/activityRegistration/playfulperson"],{"21d70":function(t,e,i){"use strict";(function(t,e){var n=i("4ea4");i("76b1");n(i("66fd"));var s=n(i("afdf"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(s.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},3540:function(t,e,i){"use strict";var n=i("8a60"),s=i.n(n);s.a},"8a60":function(t,e,i){},"8ac8":function(t,e,i){"use strict";(function(t){var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(i("2eee")),a=n(i("c973")),r=i("ed1a"),o=i("04ff"),c={components:{carousel:function(){Promise.all([i.e("common/vendor"),i.e("components/carousel/index")]).then(function(){return resolve(i("7662"))}.bind(null,i)).catch(i.oe)},MySearch:function(){i.e("components/TypeTabs/index").then(function(){return resolve(i("2b0d"))}.bind(null,i)).catch(i.oe)},MyAttention:function(){i.e("pages/activity/activityRegistration/components/MyAttention").then(function(){return resolve(i("ebef"))}.bind(null,i)).catch(i.oe)},customHead:function(){i.e("components/customHead/index").then(function(){return resolve(i("9177"))}.bind(null,i)).catch(i.oe)},ListPage:function(){i.e("pages/activity/activityRegistration/components/ListPage").then(function(){return resolve(i("44e7"))}.bind(null,i)).catch(i.oe)}},data:function(){return{sharedetail:{},triggered:!1,shopType:"",shopTypeId:"",relatedType:"",userId:"",isShopPunch:"",searchTabs:[],tags:[{name:"关注",id:0},{name:"发现",id:1}],showloading:!0,type:1,isarticle:!0,keyword:"",dataList:[],videoList:[],imgList:[],current:1,tabscurrent:0,isLoadMore:!1,visitinto:null,tagcurrent:1,videocurrent:1,imgcurrent:1,articleId:null,newuserid:null,isShowMyLike:!0,isNoShow:!1,homeMenuId:void 0,touchStartX:0,circular:!1,showBottom:!1}},onPullDownRefresh:function(){this.tosearch(),console.log(2222222),setTimeout((function(){t.stopPullDownRefresh()}),1e3)},computed:{statusBarHeight:function(){return"calc(45px + ".concat(r.statusBarHeight,")")},listHeight:function(){return"calc(100vh - 45px - 45px - ".concat(r.statusBarHeight,")")},navbarHeight:function(){return t.getStorageSync("menuInfo")?t.getStorageSync("menuInfo").contentTop:0},menuHeight:function(){return t.getStorageSync("menuInfo")?t.getStorageSync("menuInfo").menuHeight:0},menuTop:function(){return t.getStorageSync("menuInfo")?t.getStorageSync("menuInfo").menuTop-this.statusBarHeight:0}},onLoad:function(e){var i=this;return(0,a.default)(s.default.mark((function n(){var a;return s.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log(e),i.getshareimg(),a=i,i.userId=t.getStorageSync("userId"),n.next=6,i.getTabsList();case 6:e.keycode&&(i.keyword=e.keycode),e.isNoShow&&(i.isNoShow=e.isNoShow),e.homeMenuId&&(i.homeMenuId=1*e.homeMenuId),e.enter&&t.setStorageSync("enter",e.enter),e.type?(i.type=e.type,i.tagcurrent=e.type,i.getPageList()):i.getList(),e.userId&&(i.newuserid=e.userId),t.$on("changelike",(function(t){1==t.likeType?(a.imgList[t.index].article.likeType=1,a.imgList[t.index].article.likeBaseNum=a.imgList[t.index].article.likeBaseNum+1):2==t.likeType&&(a.imgList[t.index].article.likeType=2,a.imgList[t.index].article.likeBaseNum=a.imgList[t.index].article.likeBaseNum+-1)})),t.$on("changid",(function(t){a.articleId=t}));case 14:case"end":return n.stop()}}),n)})))()},onReachBottom:function(){this.isLoadMore||(this.current++,this.getList())},onShow:function(){var e=this;t.getStorageSync("token")&&this.$request.post("/coc-active/api/v1/user/behavior/visit_into",{type:5}).then((function(t){e.visitinto=t}))},onHide:function(){t.getStorageSync("token")&&this.$request.post("/coc-active/api/v1/user/behavior/visit_exit",{userVisitId:this.visitinto}).then((function(t){}))},onUnload:function(){t.getStorageSync("token")&&this.$request.post("/coc-active/api/v1/user/behavior/visit_exit",{userVisitId:this.visitinto}).then((function(t){}))},onShareAppMessage:function(e){this.share();var i="/pages/activity/activityRegistration/playfulperson?type="+this.type+"&articleId="+this.articleId+"&enter=117",n=this.sharedetail.shareTitle,s=this.sharedetail.shareImg;return{title:n,imageUrl:s,path:i,success:function(e){t.showToast({title:"分享成功"})},fail:function(e){t.showToast({title:"分享失败",icon:"none"})}}},onShareTimeline:function(e){this.share();var i="/pages/activity/activityRegistration/playfulperson?type="+this.type+"&articleId="+this.articleId+"&enter=117",n=this.sharedetail.shareTitle,s=this.sharedetail.shareImg;return{title:n,imageUrl:s,path:i,success:function(e){t.showToast({title:"分享成功"})},fail:function(e){t.showToast({title:"分享失败",icon:"none"})}}},watch:{isLoadMore:function(t){var e=this;t?setTimeout((function(){e.showBottom=!0}),2e3):this.showBottom=!1}},methods:{getshareimg:function(){var t=this;this.$newrequest.get("/coc-system/api/v1/system/dictionaries/pageLayout/details/38").then((function(e){t.sharedetail=e.data}))},refresherpulling:function(t){console.log(t),t.detail.dy<30||(this.triggered=!0)},refresherrefresh:function(){var t=this;this.tosearch(),setTimeout((function(){t.triggered=!1}),1e3)},scrolltolower:function(){this.isLoadMore||(this.current++,this.getList())},touchStart:function(t){console.log(t),this.touchStartX=t.touches[0].clientX},followTouchEnd:function(t){var e=t.changedTouches[0].clientX-this.touchStartX;console.log(t,this.tabscurrent,e),Math.abs(e)<90||e<0&&(this.tagcurrent=1,this.OnClickTags(this.tags[1]))},touchEnd:function(t){console.log(t),0===this.tabscurrent||1===this.tabscurrent||this.tabscurrent===this.searchTabs.length-1||this.tabscurrent===this.searchTabs.length-2?this.circular=!1:this.circular=!0;var e=t.changedTouches[0].clientX-this.touchStartX;if(!(Math.abs(e)<90)){if(e>0){if(0===this.tabscurrent)return this.tagcurrent=0,void this.OnClickTags(this.tags[0]);this.tabscurrent-=1}else{if(this.tabscurrent===this.searchTabs.length-1)return;this.tabscurrent+=1}this.handleTabs(this.searchTabs[this.tabscurrent])}},getTabsList:function(){var t=this;return(0,a.default)(s.default.mark((function e(){var i,n,a;return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$request.post("/coc-social/api/v2/article/getArticleSecondList",{newType:1});case 2:i=e.sent,n=i.data,a=[{value:0,name:"推荐"}],n.forEach((function(t){a.push({value:t.articleNewType,name:t.name})})),t.searchTabs=a,console.log(t.searchTabs);case 8:case"end":return e.stop()}}),e)})))()},toList:function(e){e.video?t.navigateTo({url:"/pages/activity/articlevideo/index?id="+e.articleId+"&newType=1&userType=1&title=达人推荐&tabscurrent="+this.tabscurrent+"&isShowTab=true"}):t.navigateTo({url:"/pages/activity/waterfull/imglist?id="+e.articleId+"&newType=1&userType=1"})},getTitle:function(t){var e=t.activityTitle,i=t.articleTitle,n=t.productTitle;return e||i||n},handleToggle:function(t){this.handleTabs({},t)},handleTabs:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.pageScrollTo({scrollTop:1,duration:0}),this.isLoadMore=!1,console.log(e),this.shopType="",this.relatedType="",this.shopTypeId="",this.isShopPunch="",e.shopType&&(this.shopType=e.shopType),e.shopTypeId&&(this.shopTypeId=e.shopTypeId),e.id&&(this.relatedType=e.id),e.isShopPunch&&(this.isShopPunch=e.isShopPunch),i?this.tosearch():this.keyword=""},share:function(){var t=this;1!=this.type&&2!=this.type||this.$newrequest.post("/coc-social/api/v2/article/share",{id:this.articleId}).then((function(e){200==e.code&&(1==t.type?t.videoList.filter((function(e,i){t.articleId==e.article.id&&e.article.shareBaseNum++})):t.imgList.filter((function(e,i){t.articleId==e.article.id&&e.article.shareBaseNum++})))}))},OnPushPostDetail:function(e){e.video?t.navigateTo({url:"/pages/activity/articlevideo/index?id=".concat(e.articleId,"&relatedType=").concat(this.relatedType?this.relatedType:"","&selectionType=").concat(this.shopType?this.shopType:"","&newType=1&keyword=").concat(this.keyword?this.keyword:"","&userType=2&title=达人推荐&tabscurrent=").concat(this.tabscurrent,"&isShowTab=true")}):t.navigateTo({url:"/pages/activity/waterfull/imglist?id=".concat(e.articleId,"&relatedType=").concat(this.relatedType?this.relatedType:"","&selectionType=").concat(this.shopType?this.shopType:"","&newType=1&keyword=").concat(this.keyword?this.keyword:"","&userType=2")})},sendid:function(t){var e=this;this.$newrequest.post("coc-social/api/v1/article/findById",{current:1,id:t.article.id,size:3}).then((function(i){i.data.article.imgarr=i.data.article.imgs.split(","),e.imgList.filter((function(n,s){n.article.id==t.article.id&&e.$set(e.imgList,s,i.data)}))}))},deleteimg:function(t){var e=this;this.imgList.filter((function(i,n){i.article.id==t&&e.imgList.splice(n,1)}))},detailvideo:function(t){var e=this;this.videoList.filter((function(i,n){i.article.id==t&&e.videoList.splice(n,1)}))},setnewvideo:function(t,e){this.$set(this.videoList,t,e)},likenumchange:function(t,e){2==t?(this.videoList[e].article.likeType=1,this.videoList[e].article.likeBaseNum=this.videoList[e].article.likeBaseNum+1):(this.videoList[e].article.likeType=2,this.videoList[e].article.likeBaseNum=this.videoList[e].article.likeBaseNum-1)},getPageList:function(){var t=this;return(0,a.default)(s.default.mark((function e(){return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getList();case 2:console.log(t.type,t.dataList),0==t.type&&0===t.dataList.length&&(t.isShowMyLike=!1,t.current=1,t.isLoadMore=!1,t.getList());case 4:case"end":return e.stop()}}),e)})))()},OnClickTags:function(e){var i=this;return(0,a.default)(s.default.mark((function n(){return s.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(0!==e.id){n.next=5;break}if((0,o.tologin)()){n.next=5;break}return i.tagcurrent=0,setTimeout((function(){i.tagcurrent=1}),1e3),n.abrupt("return",!1);case 5:return i.tagcurrent=e.id,i.type=e.id,t.pageScrollTo({scrollTop:1,duration:0}),i.current=1,i.dataList=[],i.articleId=null,i.isLoadMore=!1,i.isarticle=!0,i.isShowMyLike=!0,i.relatedType="",i.shopType="",i.keyword="",n.next=19,i.getPageList();case 19:case"end":return n.stop()}}),n)})))()},OnAddpost:function(){return(0,a.default)(s.default.mark((function e(){var i;return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=(0,o.tologin)(),i&&t.navigateTo({url:"/pages/wiseman/component/addimgarticle?isold=1&mustTalent=true&newType=1&isShowUploadImg=false"});case 2:case"end":return e.stop()}}),e)})))()},clear:function(){this.current=1,this.isLoadMore=!1,this.dataList=[],this.keyword="",this.getList()},tosearch:function(t){this.current=1,this.isLoadMore=!1,this.dataList=[],this.keyword=t,this.$refs.waterfallsFlowRef&&this.$refs.waterfallsFlowRef.refresh(),this.getList()},getList:function(){var t=this;return(0,a.default)(s.default.mark((function e(){var i,n;return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showloading=!0,console.log(t.type),console.log(t.isShowMyLike),i="",n=t.params,0===t.tabscurrent&&1===t.type?(i="/coc-social/api/v2/article/getExpertRecommendBySetting",n={articleType:1,current:t.current,size:10,title:t.keyword,homeMenuId:t.homeMenuId}):(i="/coc-social/api/v2/article/expertRecommend",n={current:t.current,relatedType:t.relatedType,size:10,title:t.keyword,type:0===t.type&&t.isShowMyLike?1:2,shopType:t.shopType,shopTypeId:t.shopTypeId,isShopPunch:t.isShopPunch,articleNewType:t.searchTabs[t.tabscurrent].value}),e.next=8,t.$newrequest.post(i,n).then((function(e){var i;(0==e.data.total?t.isarticle=!1:t.isarticle=!0,e.data.records.filter((function(t,e){t.imgs?t.coverPicture=t.imgs.split(",")[0]:t.articleCoverImage?t.coverPicture=t.articleCoverImage:t.video&&(t.coverPicture=t.video+"?x-oss-process=video/snapshot,t_1000,m_fast")})),e.data.records.length<10&&(t.isLoadMore=!0),1==t.current)?t.dataList=(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.records)||[]:e.data.records.filter((function(e){t.dataList.push(e)}));t.showloading=!1}));case 8:case"end":return e.stop()}}),e)})))()}}};e.default=c}).call(this,i("543d")["default"])},9385:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return n}));var n={uAvatar:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-avatar/u-avatar")]).then(i.bind(null,"d838"))},customWaterfallsFlow:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/custom-waterfalls-flow/components/custom-waterfalls-flow/custom-waterfalls-flow")]).then(i.bind(null,"bb0e"))},uLoadingPage:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-loading-page/u-loading-page")]).then(i.bind(null,"e325"))}},s=function(){var t=this,e=t.$createElement,i=(t._self._c,0==t.type&&t.isShowMyLike?t.__map(t.dataList,(function(e,i){var n=t.__get_orig(e),s=t.getTitle(e);return{$orig:n,m0:s}})):null),n=0!=t.type&&1==t.type?t.__get_style([t.isNoShow?"10rpx":{paddingTop:"48px"}]):null;t.$mp.data=Object.assign({},{$root:{l0:i,s0:n}})},a=[]},afdf:function(t,e,i){"use strict";i.r(e);var n=i("9385"),s=i("ecd0");for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);i("3540"),i("c516");var r=i("f0c5"),o=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,"510100e3",null,!1,n["a"],void 0);e["default"]=o.exports},c516:function(t,e,i){"use strict";var n=i("f126"),s=i.n(n);s.a},ecd0:function(t,e,i){"use strict";i.r(e);var n=i("8ac8"),s=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=s.a},f126:function(t,e,i){}},[["21d70","common/runtime","common/vendor"]]]);