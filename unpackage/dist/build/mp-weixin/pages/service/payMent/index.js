(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/service/payMent/index"],{"22fd":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return o}));var o={uNavbar:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-navbar/u-navbar")]).then(i.bind(null,"45e8"))},uIcon:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(i.bind(null,"f23e"))},uDivider:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-divider/u-divider")]).then(i.bind(null,"4e62"))},uSwitch:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-switch/u-switch")]).then(i.bind(null,"fd83"))},uAvatar:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-avatar/u-avatar")]).then(i.bind(null,"6d2c"))},uRate:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-rate/u-rate")]).then(i.bind(null,"2b73"))},uLoadingPage:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-loading-page/u-loading-page")]).then(i.bind(null,"fbb6"))},uToast:function(){return i.e("uni_modules/uview-ui/components/u-toast/u-toast").then(i.bind(null,"4bf8"))}},n=function(){var e=this.$createElement,t=(this._self._c,this.insuranceList.length),i=1!=this.isScoreDeduction?this.couponList.length:null,o=1!=this.isScoreDeduction&&0!=i?this.choosecoupon.length:null,n=this.totalprice.toFixed(2);this.$mp.data=Object.assign({},{$root:{g0:t,g1:i,g2:o,g3:n}})},s=[]},"7c12":function(e,t,i){"use strict";i.r(t);var o=i("e3da"),n=i.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(s);t["default"]=n.a},"8c53":function(e,t,i){"use strict";var o=i("d44e"),n=i.n(o);n.a},"9ceb":function(e,t,i){"use strict";i.r(t);var o=i("22fd"),n=i("7c12");for(var s in n)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(s);i("8c53");var a=i("f0c5"),c=Object(a["a"])(n["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=c.exports},d44e:function(e,t,i){},e3da:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i("7dcd"),n={components:{recommend:function(){Promise.all([i.e("common/vendor"),i.e("pages/service/components/recommend")]).then(function(){return resolve(i("65fe"))}.bind(null,i)).catch(i.oe)}},data:function(){return{isvalue:!1,showloading:!1,userId:"",value:1,insuranceList:[],MealName:"",setMealNum:"",flashSalePrice:"",Events:"",allpeople:"",day:"",officialrelief:"",totalprice:"",setMealId:"",activityId:"",signUpId:"",orderNo:"",orderdetail:null,choosepeople:"",couponList:[],choosecoupon:[],isScoreDeduction:0,scoreDeduction:0,surplusScore:0,istype:0}},onLoad:function(t){var i=this,n=this;if(this.getOpenerEventChannel().on){var s=this.getOpenerEventChannel();s.on("payinfo",(function(t){e.$u.sleep(0).then((function(){n.insuranceList=t.data.list,n.couponList=t.data.couponVOS}))})),this.userId=(0,o.getstorage)("userId"),this.MealName=t.MealName,this.setMealNum=t.setMealNum,this.flashSalePrice=t.flashSalePrice,this.Events=t.Events,this.allpeople=t.allpeople,this.choosepeople=t.choosepeople,this.officialrelief=t.officialrelief,this.totalprice=100*t.totalprice/100,this.activityId=t.activityId,this.setMealId=t.setMealId,this.signUpId=t.signUpId,this.orderNo=t.orderNo,this.day=t.day,this.isScoreDeduction=t.isScoreDeduction,this.scoreDeduction=t.scoreDeduction,this.surplusScore=t.surplusScore}else{var a=JSON.parse(t.data);this.userId=(0,o.getstorage)("userId"),this.MealName=a.MealName,this.setMealNum=a.setMealNum,this.flashSalePrice=a.flashSalePrice,this.Events=a.Events,this.allpeople=a.allpeople,this.choosepeople=a.choosepeople,this.officialrelief=a.officialrelief,this.totalprice=100*a.totalprice/100,this.activityId=a.activityId,this.setMealId=a.setMealId,this.signUpId=a.signUpId,this.orderNo=a.orderNo,this.day=a.day,this.isScoreDeduction=a.isScoreDeduction,this.scoreDeduction=a.scoreDeduction,this.surplusScore=a.surplusScore,this.insuranceList=a.isInsuranceVOS,this.couponList=a.couponVOS,this.istype=1}(0,o.getstorage)("token")||(0,o.tologin)(),e.$on("choosecoupon",(function(e){i.choosecoupon=e.data,i.totalprice=100*t.totalprice/100,i.choosecoupon.filter((function(e){i.totalprice=i.totalprice-e.discountMoney})),i.totalprice<=0&&(i.totalprice=.01)}))},onShow:function(){},methods:{toClick:function(){e.navigateTo({url:"/pages/activity/activityRegistration/playfulperson"})},OnPushshop:function(){3==this.orderdetail.shopTypeId?e.navigateTo({url:"/pages/activityMall/business/index?id="+this.orderdetail.shopId}):2==this.orderdetail.shopTypeId&&e.navigateTo({url:"/pages/carShops/4Sdetail/index?id="+this.orderdetail.shopId})},changvalue:function(e){e?(this.totalprice=parseFloat(this.totalprice)-parseFloat(this.scoreDeduction),0==this.totalprice&&(this.totalprice=.01)):(.01==this.totalprice&&(this.totalprice=0),this.totalprice=parseFloat(this.totalprice)+parseFloat(this.scoreDeduction))},OnPushcoupon:function(){if(this.orderdetail)return!1;var t=this;e.navigateTo({url:"/pages/service/couponList/index",success:function(e){e.eventChannel.emit("couponList",{data:{couponList:t.couponList,choosecoupon:t.choosecoupon}})}})},Onreturn:function(){e.navigateBack({delta:2})},Onreport:function(){var t={shopVO:{headImg:this.orderdetail.shopAvatar,shopName:this.orderdetail.shopName,id:this.orderdetail.activityId},activity:{createdAt:this.orderdetail.createdAt,title:this.orderdetail.title,detail:""}};e.navigateTo({url:"/pages/my/myFeedback/index?type=1",success:function(e){e.eventChannel.emit("getinfo",{data:t})}})},OnGoHome:function(){e.switchTab({url:"/pages/home/index"})},getcode:function(){var e=this;this.$request.post("/coc-my/activity/order/detail/v2",{orderNo:this.orderNo}).then((function(t){e.orderdetail=t.data}))},OnPay:function(){var e=this,t=!1;t=0==this.insuranceList.length?0:1;var i=[];this.choosecoupon.filter((function(e){i.push({discountMoney:e.discountMoney,couponNewId:e.couponNewId,couponUserNewId:e.couponUserNewId})})),this.showloading=!0;var n=0;this.isvalue&&(n=this.scoreDeduction),this.$request.post("/coc-active/api/v1/sign_up/payment",{scoreDeduction:n,couponUserNews:i,payType:"3",signUpId:this.signUpId,activityId:this.activityId,setMealId:this.setMealId,isInsurance:t,subOpenId:(0,o.getstorage)("openid"),setMealAmount:this.flashSalePrice}).then((function(t){200==t.code?(e.showloading=!1,e.wxpay(t.data.payment.miniPayRequest)):(e.showloading=!1,e.$refs.uToast.show({message:t.message}))}))},wxpay:function(t){var i=this;e.requestPayment({provider:"wxpay",timeStamp:t.timeStamp,nonceStr:t.nonceStr,package:t.package,signType:t.signType,paySign:t.paySign,appid:t.appId,success:function(t){e.showToast({icon:"success",title:"支付成功",complete:function(){i.getcode()}})},fail:function(t){i.$request.get("/coc-active/api/v1/sign_up/paymentFailed/"+i.signUpId).then((function(e){})),e.showToast({icon:"none",title:"支付失败"})}})}}};t.default=n}).call(this,i("543d")["default"])},fbf9:function(e,t,i){"use strict";(function(e,t){var o=i("4ea4");i("4319");o(i("66fd"));var n=o(i("9ceb"));e.__webpack_require_UNI_MP_PLUGIN__=i,t(n.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])}},[["fbf9","common/runtime","common/vendor"]]]);