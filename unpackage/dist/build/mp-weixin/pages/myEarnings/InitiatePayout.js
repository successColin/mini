(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myEarnings/InitiatePayout"],{"4ca4":function(n,i,e){"use strict";(function(n){var t=e("4ea4");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=t(e("2eee")),a=t(e("c973")),u={components:{},data:function(){return{showpop:!1,show:!1,isInvoicing:"0",withdrawPrice:0,balance:0,bank:{},info:{email:"",brancdutyParagraph:"",invoiceHeader:"",invoiceName:"服务费",invoiceImg:""},fileList1:[],picUrl:"",showload:!1,isclick:!1}},onLoad:function(n){console.log(n),n.balance&&(this.balance=Number(n.balance),this.withdrawPrice=Number(n.balance)),this.getInfo()},onShow:function(){var i=this;n.$on("bankdata",(function(n){i.bank=n}))},methods:{checkBank:function(){n.navigateTo({url:"/pages/myEarnings/bankList"})},getInfo:function(){var n=this;this.$request.post("/coc-merchant-app/app/v2/invoicing/getDetails",{id:1}).then((function(i){n.info=i.data,n.info.invoiceName="服务费"}))},deletePic:function(n){this["fileList".concat(n.name)].splice(n.index,1)},afterRead:function(n){var i=this;return(0,a.default)(o.default.mark((function e(){var t;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=[].concat(n.file),t.map((function(n,e){i.fileList1.push({url:n.url,status:"success",message:""})}));case 2:case"end":return e.stop()}}),e)})))()},widthdrawBtn:function(){this.bank.bankName&&this.withdrawPrice?1==this.isInvoicing?this.fileList1.length?(this.picUrl=this.fileList1[0].url,this.uploadFilePromise()):n.showToast({title:"请上传发票印件",icon:"none",duration:2e3}):(this.picUrl="",this.save()):n.showToast({title:"请确认银行信息和输入金额不为空",icon:"none",duration:2e3})},uploadFilePromise:function(){var i=this,e=this;this.showload=!0,e.info.invoiceImg="",this.fileList1.filter((function(n,i){n.index=i}));var t=[],o=this.fileList1.map((function(i){return console.log(i),new Promise((function(e,o){n.uploadFile({url:getApp().globalData.uploadUrl,filePath:i.url,name:"file",formData:{file:i.url},success:function(n){t.push({index:i.index,data:JSON.parse(n.data).data}),e(n)}})}))}));Promise.all(o).then((function(n){var o=t.sort((function(n,i){return n.index-i.index}));o.filter((function(n){e.info.invoiceImg=n.data})),i.save()}))},save:function(){this.isclick||(this.isclick=!0,this.$request.post("/coc-active/api/v2/withdraw/add",{bankCardId:this.bank.bankCardId,dutyParagraph:this.info.uniformSocialCreditCode,email:this.info.email,invoiceHeader:this.info.shopName,invoiceName:this.info.invoiceName,isInvoicing:Number(this.isInvoicing),withdrawPrice:Number(this.withdrawPrice),invoiceImg:this.info.invoiceImg}).then((function(i){200==i.code?(n.showToast({title:"提现成功",icon:"none",duration:2e3}),setTimeout((function(){n.redirectTo({url:"/pages/myEarnings/withdrawlist"})}),1e3)):n.showToast({title:i.message,icon:"none",duration:2e3})})))},onRequest:function(){}}};i.default=u}).call(this,e("543d")["default"])},"4d9e":function(n,i,e){"use strict";e.r(i);var t=e("4ca4"),o=e.n(t);for(var a in t)["default"].indexOf(a)<0&&function(n){e.d(i,n,(function(){return t[n]}))}(a);i["default"]=o.a},"517aa":function(n,i,e){"use strict";var t=e("f37c"),o=e.n(t);o.a},"6b6d":function(n,i,e){"use strict";e.d(i,"b",(function(){return o})),e.d(i,"c",(function(){return a})),e.d(i,"a",(function(){return t}));var t={uIcon:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(e.bind(null,"f23e"))},uRadioGroup:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-radio-group/u-radio-group")]).then(e.bind(null,"35d2"))},uRadio:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-radio/u-radio")]).then(e.bind(null,"df92"))},uUpload:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-upload/u-upload")]).then(e.bind(null,"8f994"))},uToast:function(){return e.e("uni_modules/uview-ui/components/u-toast/u-toast").then(e.bind(null,"4bf8"))},uLoadingIcon:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-loading-icon/u-loading-icon")]).then(e.bind(null,"8a2a"))}},o=function(){var n=this.$createElement;this._self._c},a=[]},c59f:function(n,i,e){"use strict";e.r(i);var t=e("6b6d"),o=e("4d9e");for(var a in o)["default"].indexOf(a)<0&&function(n){e.d(i,n,(function(){return o[n]}))}(a);e("517aa");var u=e("f0c5"),c=Object(u["a"])(o["default"],t["b"],t["c"],!1,null,"308dd3f6",null,!1,t["a"],void 0);i["default"]=c.exports},f37c:function(n,i,e){},f571:function(n,i,e){"use strict";(function(n,i){var t=e("4ea4");e("4319");t(e("66fd"));var o=t(e("c59f"));n.__webpack_require_UNI_MP_PLUGIN__=e,i(o.default)}).call(this,e("bc2e")["default"],e("543d")["createPage"])}},[["f571","common/runtime","common/vendor"]]]);