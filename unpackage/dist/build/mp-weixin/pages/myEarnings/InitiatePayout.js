(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myEarnings/InitiatePayout"],{"02d6":function(i,n,e){"use strict";var t=e("f910"),a=e.n(t);a.a},"420d":function(i,n,e){"use strict";(function(i,n){var t=e("4ea4");e("76b1");t(e("66fd"));var a=t(e("ab7e"));i.__webpack_require_UNI_MP_PLUGIN__=e,n(a.default)}).call(this,e("bc2e")["default"],e("543d")["createPage"])},ab7e:function(i,n,e){"use strict";e.r(n);var t=e("e32b"),a=e("ea13");for(var o in a)["default"].indexOf(o)<0&&function(i){e.d(n,i,(function(){return a[i]}))}(o);e("02d6");var s=e("f0c5"),c=Object(s["a"])(a["default"],t["b"],t["c"],!1,null,"1fab9494",null,!1,t["a"],void 0);n["default"]=c.exports},d0f2:function(i,n,e){"use strict";(function(i){var t=e("4ea4");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=t(e("2eee")),o=t(e("c973")),s={components:{},data:function(){return{showpop:!1,show:!1,isInvoicing:"0",withdrawType:"0",withdrawPrice:0,balance:0,bank:{},info:{email:"",brancdutyParagraph:"",invoiceHeader:"",invoiceName:"服务费",invoiceImg:""},fileList1:[],picUrl:"",showload:!1,isclick:!1,licenceParams:{},withdrawBasic:{},disabledRadio:!1,disableBill:!1,permissionArr:[]}},onLoad:function(i){console.log(i),i.balance&&(this.balance=Number(i.balance),this.withdrawPrice=Number(i.balance)),this.getInfo(),this.getWithdrawInfo(),this.getWithdrawType()},onShow:function(){var n=this;i.$on("bankdata",(function(i){n.bank=i}))},watch:{withdrawType:function(i){1==i?(this.isInvoicing="1",this.disableBill=!0):(this.disableBill=!1,this.withdrawPrice>800&&(this.isInvoicing="1",this.disableBill=!0))},withdrawPrice:function(i){console.log(i),i>800?(this.isInvoicing="1",this.disableBill=!0):this.disableBill=!1}},methods:{handleChange:function(){this.getWithdrawInfo()},handleClickIcon:function(){var i="";i=0==this.withdrawType?"当月累计佣金金额不超过4000元且单笔佣金金额在800元以下的，可选择不开票;\n          当月累计佣金金额超过4000元或单笔佣金金额大于800元的，需提供税务机关代开\n          的增值税普通发票。由51车俱乐部直接按照劳务报酬所得计算代扣代缴个人所得税。\n        ":"开具非自然人开具的增值税发票（包括免税发票），按应打款佣金金额结算",this.$refs.uToast.show({message:i})},handleUpload:function(i){return(0,o.default)(a.default.mark((function i(){return a.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:case"end":return i.stop()}}),i)})))()},checkBank:function(){i.navigateTo({url:"/pages/myEarnings/bankList"})},getInfo:function(){var i=this;this.$request.post("/coc-merchant-app/app/v2/invoicing/getDetails",{id:1}).then((function(n){i.info=n.data,i.info.invoiceName="服务费"}))},getWithdrawType:function(){var i=this;this.$request.post("/coc-active/api/v2/withdraw/isAbleOfThePublic").then((function(n){200===n.code&&(i.disabledRadio=!0)}))},getWithdrawInfo:function(){var n=this;this.$request.post("/coc-active/api/v2/withdraw/getWithdrawBaseInfo",{withdrawPrice:this.withdrawPrice}).then((function(e){if(200!==e.code)return i.showToast({title:e.message,icon:"none",duration:2e3});n.withdrawBasic=e.data,n.withdrawBasic.monthAccumulateWithdraw>4e3&&(n.isInvoicing="1",n.disableBill=!0)}))},handleDelete:function(){this.permissionArr=[]},deletePic:function(i){this["fileList".concat(i.name)].splice(i.index,1)},handleAfterRead:function(n){var e=[].concat(n.file),t=this;this.$newrequest.get("/coc-file/api/v1/oss/policy").then((function(n){e.map((function(e,a){var o="";o=e.url.split("/")[3]?e.url.split("/")[3]:e.url.split("/")[2],i.uploadFile({url:"https://oss.dcqcjlb.com/",filePath:e.url,name:"file",formData:{key:n.data.dir+o,policy:n.data.policy,OSSAccessKeyId:n.data.accessid,signature:n.data.signature,success_action_status:"200"},success:function(e){var a="https://oss.dcqcjlb.com/"+n.data.dir+o;t.$request.post("/coc-active/api/v2/withdraw/recognizeBankAccountLicense",{licenceImg:a}).then((function(n){if(t.permissionArr.push({url:a,status:"success",message:""}),200===n.code){var e=n.data,o=e.accountName,s=e.corporateAccount,c=e.depositBank;t.licenceParams={name:o,account:s,bank:c}}else i.showToast({title:n.message,icon:"none",duration:2e3})}))}})}))}))},afterRead:function(i){var n=this;return(0,o.default)(a.default.mark((function e(){var t;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=[].concat(i.file),t.map((function(i,e){n.fileList1.push({url:i.url,status:"success",message:""})}));case 2:case"end":return e.stop()}}),e)})))()},widthdrawBtn:function(){if(this.bank.bankName&&this.withdrawPrice){if(1==this.withdrawType&&(1!==this.permissionArr.length||!this.licenceParams.name||!this.licenceParams.account||!this.licenceParams.bank))return i.showToast({title:"请确认开户许可证信息",icon:"none",duration:2e3});1==this.isInvoicing?this.fileList1.length?(this.picUrl=this.fileList1[0].url,this.uploadFilePromise()):i.showToast({title:"请上传发票印件",icon:"none",duration:2e3}):(this.picUrl="",this.save())}else i.showToast({title:"请确认银行信息和输入金额不为空",icon:"none",duration:2e3})},uploadFilePromise:function(){var n=this,e=this;e.info.invoiceImg="",this.fileList1.filter((function(i,n){i.index=n}));var t=[],a=this.fileList1.map((function(n){return console.log(n),new Promise((function(e,a){i.uploadFile({url:getApp().globalData.uploadUrl,filePath:n.url,name:"file",formData:{file:n.url},success:function(i){t.push({index:n.index,data:JSON.parse(i.data).data}),e(i)}})}))}));Promise.all(a).then((function(i){var a=t.sort((function(i,n){return i.index-n.index}));a.filter((function(i){e.info.invoiceImg=i.data})),n.save()}))},save:function(){var n,e,t=this;this.isclick||(this.isclick=!0,this.$request.post("/coc-active/api/v2/withdraw/add",{bankCardId:this.bank.bankCardId,dutyParagraph:this.info.uniformSocialCreditCode,email:this.info.email,invoiceHeader:this.info.shopName,invoiceName:this.info.invoiceName,isInvoicing:Number(this.isInvoicing),withdrawPrice:Number(this.withdrawPrice),invoiceImg:this.info.invoiceImg,isCorporate:this.withdrawType,accountName:this.licenceParams.name,corporateAccount:this.licenceParams.account,depositBank:this.licenceParams.bank,licenceImg:(null===(n=this.permissionArr)||void 0===n||null===(e=n[0])||void 0===e?void 0:e.url)||""}).then((function(n){t.isclick=!1,200==n.code?(i.showToast({title:"提现成功",icon:"none",duration:2e3}),setTimeout((function(){i.redirectTo({url:"/pages/myEarnings/withdrawlist"})}),1e3)):i.showToast({title:n.message,icon:"none",duration:2e3})})))},onRequest:function(){}}};n.default=s}).call(this,e("543d")["default"])},e32b:function(i,n,e){"use strict";e.d(n,"b",(function(){return a})),e.d(n,"c",(function(){return o})),e.d(n,"a",(function(){return t}));var t={uIcon:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(e.bind(null,"0f14"))},uRadioGroup:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-radio-group/u-radio-group")]).then(e.bind(null,"8f9f"))},uRadio:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-radio/u-radio")]).then(e.bind(null,"37f9"))},uUpload:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-upload/u-upload")]).then(e.bind(null,"9a59"))},"u-Input":function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u--input/u--input")]).then(e.bind(null,"c00c"))},uToast:function(){return e.e("uni_modules/uview-ui/components/u-toast/u-toast").then(e.bind(null,"1b13"))},uLoadingIcon:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uview-ui/components/u-loading-icon/u-loading-icon")]).then(e.bind(null,"db21"))}},a=function(){var i=this.$createElement;this._self._c},o=[]},ea13:function(i,n,e){"use strict";e.r(n);var t=e("d0f2"),a=e.n(t);for(var o in t)["default"].indexOf(o)<0&&function(i){e.d(n,i,(function(){return t[i]}))}(o);n["default"]=a.a},f910:function(i,n,e){}},[["420d","common/runtime","common/vendor"]]]);