require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/wiseman/specialarea/message_comment"],{"240f":function(e,t,n){"use strict";(function(e){var i=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n("2eee")),s=i(n("9523")),a=i(n("c973")),u=n("04ff");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={data:function(){return{dataList:[],searchField:{current:1,size:10,type:3},loadMore:!1,isReachBottom:!1,imgsbig:"",popimgs:!1,chosecomment:{},showcomment:!1,isend:!0,fileList:[]}},onLoad:function(){this.getList(),this.readMessage()},onReachBottom:function(){this.isReachBottom||this.loadMore||(this.searchField.current+=1,this.getList())},methods:{readMessage:function(){this.$newrequest.post("/coc-active/api/v1/newExpert/viewExpertMessage",{type:this.searchField.type}).then((function(t){200===t.code||e.showToast({title:t.message,icon:"none",duration:2e3})}))},getList:function(){var t=this;this.loadMore=!0,this.$newrequest.post("/coc-active/api/v1/newExpert/expertMessageList",this.searchField).then((function(n){200===n.code?(1===t.searchField.current?t.dataList=n.data.records:n.data.records.forEach((function(e){t.dataList.push(e)})),n.data.records.length<t.searchField.size&&(t.isReachBottom=!0)):e.showToast({title:n.message,icon:"none",duration:2e3})})).finally((function(){t.loadMore=!1}))},OnOpenImg:function(e){this.imgsbig=e,this.popimgs=!0},closeimg:function(){this.popimgs=!1},opencomment:function(e){!0===(0,u.tologin)()&&(this.chosecomment={},this.chosecomment.commentType=4,this.chosecomment.id=e.commentId,this.showcomment=!0)},closecomment:function(){this.chosecomment={},this.showcomment=!1},afterRead:function(e){var t=this;return(0,a.default)(o.default.mark((function n(){var i,s,a,u;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:i=[].concat(e.file),i.map((function(e,n){t.fileList.push(r(r({},e),{},{status:"uploading",message:"上传中",uploadstatus:!1}))})),s=0;case 3:if(!(s<t.fileList.length)){n.next=16;break}if(a=t.fileList[s],"uploading"!==a.status||t.fileList[s].uploadstatus){n.next=13;break}return t.fileList[s].uploadstatus=!0,n.next=9,t.uploadFilePromise(a.url);case 9:u=n.sent,t.fileList[s].url=u,t.fileList[s].status="success",t.fileList[s].message="";case 13:s++,n.next=3;break;case 16:case"end":return n.stop()}}),n)})))()},uploadFilePromise:function(t){return new Promise((function(n,i){e.uploadFile({url:getApp().globalData.uploadUrl,filePath:t,name:"file",formData:{user:"test"},success:function(e){setTimeout((function(){n(JSON.parse(e.data).data)}),0)}})}))},deletePic:function(e){this.fileList.splice(e.index,1)},submitcomments:function(){var e=this;if(!this.isend)return!1;this.isend=!1;var t=null;this.fileList.length>0&&(t=this.fileList[0].url),t=t?[t]:null,this.$request.post("/coc-social/api/v2/article/comment",Object.assign({imgs:t},this.chosecomment)).then((function(t){200==t.code?(e.$refs.uToast.show({message:"评论成功"}),e.isend=!0,e.fileList=[],e.closecomment()):(e.isend=!0,e.$refs.uToast.show({message:t.message}))}))},jumpDetail:function(t){var n="";n=t.videoList&&t.videoList.length>0?"/pages/activity/articlevideo/index?id="+t.articleId:"/pages/activity/waterfull/imglist?id="+t.articleId,e.navigateTo({url:n})}}};t.default=l}).call(this,n("543d")["default"])},2821:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return i}));var i={uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,"0f14"))},uLoadingIcon:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-loading-icon/u-loading-icon")]).then(n.bind(null,"db21"))},uPopup:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(n.bind(null,"8add"))},"u-Textarea":function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u--textarea/u--textarea")]).then(n.bind(null,"f44e"))},uUpload:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-upload/u-upload")]).then(n.bind(null,"9a59"))},uToast:function(){return n.e("uni_modules/uview-ui/components/u-toast/u-toast").then(n.bind(null,"1b13"))}},o=function(){var e=this,t=e.$createElement,n=(e._self._c,e.dataList.length),i=n>0?e.__map(e.dataList,(function(t,n){var i=e.__get_orig(t),o=t.commentImgsList.length,s=5==t.type?t.myCommentImgsList.length:null,a=!t.videoList||0==t.videoList.length,u=t.videoList&&t.videoList.length>0,c=t.videoList&&t.videoList.length>0;return{$orig:i,g1:o,g2:s,g3:a,g4:u,g5:c}})):null,o=e.dataList.length>0&&e.isReachBottom;e.$mp.data=Object.assign({},{$root:{g0:n,l0:i,g6:o}})},s=[]},"6c8a":function(e,t,n){"use strict";(function(e,t){var i=n("4ea4");n("76b1");i(n("66fd"));var o=i(n("8e79"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},7543:function(e,t,n){"use strict";n.r(t);var i=n("240f"),o=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a},"80e9":function(e,t,n){},"8e79":function(e,t,n){"use strict";n.r(t);var i=n("2821"),o=n("7543");for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);n("e5b9");var a=n("f0c5"),u=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"0300b593",null,!1,i["a"],void 0);t["default"]=u.exports},e5b9:function(e,t,n){"use strict";var i=n("80e9"),o=n.n(i);o.a}},[["6c8a","common/runtime","common/vendor"]]]);