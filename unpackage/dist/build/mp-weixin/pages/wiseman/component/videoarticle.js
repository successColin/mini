require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/wiseman/component/videoarticle"],{5378:function(e,t,i){"use strict";(function(e){var n=i("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(i("2eee")),a=n(i("9523")),s=n(i("c973"));function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){(0,a.default)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var l={components:{popcomment:function(){Promise.all([i.e("common/vendor"),i.e("components/pop/popcomment")]).then(function(){return resolve(i("052f6"))}.bind(null,i)).catch(i.oe)}},data:function(){return{isshowitem:!0,list:[{name:"贴文删除",color:"#D91B1B",fontSize:"20"},{name:"取消",fontSize:"20"}],showsheet:!1,userId:"",imgsbig:"",fileList:[],showcommentpop:!1,showreply:!1,chosecomment:{},showload:!1,showcomment:!1,index:"",endid:"",id:"",changid:"",isplay:!1,swiperindex:0,dataList:[],textcontent:"",replyid:"",popimgs:!1,isshowpage:!1}},onLoad:function(t){t.enter&&e.setStorageSync("enter",t.enter);var i=this;e.createVideoContext("play0").play(),this.userId=e.getStorageSync("userId"),this.id=t.id,this.changid=t.id,this.getdetail(),e.$on("closepop",(function(e){i.showpop=!1}))},onShareAppMessage:function(t){var i=this,n="";return this.dataList.filter((function(e){e.article.id==i.changid&&(n=e.article.title)})),this.share(),{title:n,path:"/pages/wiseman/component/videoarticle?id="+this.changid+"&enter=117",success:function(t){e.showToast({title:"分享成功"})},fail:function(t){e.showToast({title:"分享失败",icon:"none"})}}},onShareTimeline:function(t){var i=this;this.share();var n="";return this.dataList.filter((function(e){e.article.id==i.changid&&(n=e.article.title)})),{title:n,path:"/pages/wiseman/component/videoarticle?id="+this.changid+"&enter=117",success:function(t){e.showToast({title:"分享成功"})},fail:function(t){e.showToast({title:"分享失败",icon:"none"})}}},onShow:function(){},methods:{animationfinish:function(){this.isshowitem=!0},OnSelectsheet:function(t){"贴文删除"==t.name&&this.$request.post("/coc-social/api/v2/article/addArticle",{articleId:this.changid,articleUserId:this.userId}).then((function(t){200==t.code?(e.$u.toast("删除成功"),setTimeout((function(){e.navigateBack({delta:1})}),1e3)):e.$u.toast(t.message)}))},Onshowsheet:function(){this.showsheet=!0},delComments:function(t){var i=this;this.$request.post("/coc-active/api/v1/comments/delComments",{id:t}).then((function(t){200==t.code?(e.$u.toast("删除成功"),i.getnewdata()):i.$refs.uToast.show({message:t.message})}))},closeimg:function(){this.popimgs=!1},OnOpenImg:function(e){this.imgsbig=e.imgs,this.popimgs=!0},Onreplyfirst:function(){var t=this,i=[];console.log(this.fileList[0]),this.fileList.length>0&&(i=[this.fileList[0].url]),this.$request.post("/coc-social/api/v2/article/comment",{commentType:2,content:this.textcontent,id:this.changid,imgs:i}).then((function(i){200==i.code?(t.textcontent="",t.showcommentpop=!1,t.getnewdata()):e.$u.toast(i.message)}))},uploadFilePromise:function(t){return new Promise((function(i,n){e.uploadFile({url:getApp().globalData.uploadUrl,filePath:t,name:"file",formData:{user:"test"},success:function(e){setTimeout((function(){i(JSON.parse(e.data).data)}),0)}})}))},afterRead:function(e){var t=this;return(0,s.default)(o.default.mark((function i(){var n,a,s,r;return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:n=[].concat(e.file),n.map((function(e,i){t.fileList.push(c(c({},e),{},{status:"uploading",message:"上传中",uploadstatus:!1}))})),a=0;case 3:if(!(a<t.fileList.length)){i.next=16;break}if(s=t.fileList[a],"uploading"!==s.status||t.fileList[a].uploadstatus){i.next=13;break}return t.fileList[a].uploadstatus=!0,i.next=9,t.uploadFilePromise(s.url);case 9:r=i.sent,t.fileList[a].url=r,t.fileList[a].status="success",t.fileList[a].message="";case 13:a++,i.next=3;break;case 16:case"end":return i.stop()}}),i)})))()},deletePic:function(e){this.fileList.splice(e.index,1)},getnewdata:function(){var e=this;this.$request.post("coc-social/api/v1/article/findById",{current:1,id:this.changid,size:99}).then((function(t){e.dataList.filter((function(i,n){i.article.id==e.changid&&e.$set(e.dataList,n,t.data)}))}))},Onreplypop:function(){var t=this;this.$request.post("/coc-social/api/v2/article/comment",{commentType:4,content:this.textcontent,id:this.replyid}).then((function(i){200==i.code?(t.textcontent="",t.showreply=!1,t.getnewdata()):e.$u.toast(i.message)}))},Onreply:function(e){console.log(e),this.replyid=e.commentId,this.showreply=!0},Onopencomment:function(){this.showcomment=!0},Onpushmap:function(t){e.getLocation({type:"gcj02",success:function(i){var n=t.article.lat,o=t.article.lng;e.openLocation({latitude:n,longitude:o,success:function(){console.log("success")}})}})},share:function(){var e=this;this.$request.post("/coc-social/api/v2/article/share",{id:this.changid}).then((function(t){200==t.code&&e.dataList.filter((function(t){t.article.id==e.changid&&t.article.shareBaseNum++}))}))},OnlikeBase:function(t){var i=this;this.$request.post("/coc-social/api/v2/article/like",{id:this.dataList[t].article.id}).then((function(n){200==n.code?2==i.dataList[t].article.likeType?(i.dataList[t].article.likeType=1,i.dataList[t].article.likeBaseNum=i.dataList[t].article.likeBaseNum+1):(i.dataList[t].article.likeType=2,i.dataList[t].article.likeBaseNum=i.dataList[t].article.likeBaseNum-1):e.showToast({title:n.message,icon:"none"})}))},getdetail:function(){var t=this;this.isshowpage||this.$showLoading();var i=this;this.$request.post("coc-social/api/v1/article/findById",{current:1,id:this.id,size:99}).then((function(n){if(!n.data)return e.$u.toast("该贴文已删除，正在为您转跳达人推荐"),setTimeout((function(){e.redirectTo({url:"/pages/activity/activityRegistration/playfulperson?"})}),1500),!1;t.dataList.push(n.data),setTimeout((function(){i.getList()}),100)}))},getList:function(){var e=this;this.$request.post("/coc-social/api/v2/article/ids",{id:this.id}).then((function(t){10==t.data.length&&(e.endid=t.data[9].article.id),t.data.filter((function(i){console.log(t.data),e.dataList.push(i)}))})).catch((function(e){})).finally((function(){e.isshowpage||(e.isshowpage=!0,e.$hideLoading())}))},OnClickVideo:function(t){this.isplay?(this.isplay=!1,e.createVideoContext("play"+t).play()):(this.isplay=!0,e.createVideoContext("play"+t).pause())},Onpushdetail:function(t){var i,n,o,a,s,r,c,l,u,d,p,h,f=t.expertShopSelection?t.expertShopSelection.relatedId:null===(i=t.expertSelectionLibrary)||void 0===i?void 0:i.relatedId;if(t.expertShopSelection)2==t.expertShopSelection.type||2==(null===(n=t.expertSelectionLibrary)||void 0===n?void 0:n.type)?e.navigateTo({url:"/pages/carShops/upkeep/detail?id="+f+"&forwardUserId="+t.article.userId}):3==t.expertShopSelection.type||3==(null===(o=t.expertSelectionLibrary)||void 0===o?void 0:o.type)?e.navigateTo({url:"/pages/roadhelp/index?forwardUserId="+t.article.userId}):1==t.expertShopSelection.type||1==(null===(a=t.expertSelectionLibrary)||void 0===a?void 0:a.type)?e.navigateTo({url:"/pages/home/activityDetail/index?id="+f+"&forwardUserId="+t.article.userId}):4==t.expertShopSelection.type||4==(null===(s=t.expertSelectionLibrary)||void 0===s?void 0:s.type)?e.navigateTo({url:"/pages/grouppurchase/detail?id="+f+"&forwardUserId="+t.article.userId}):5!=t.expertShopSelection.type&&5!=(null===(r=t.expertSelectionLibrary)||void 0===r?void 0:r.type)||e.navigateTo({url:"/pages/activity/activityRegistration/packagedetail?id="+f+"&forwardUserId="+t.article.userId});else if(2==(null===(c=t.expertSelectionLibrary)||void 0===c?void 0:c.type))e.navigateTo({url:"/pages/carShops/upkeep/detail?id="+f+"&forwardUserId="+t.article.userId});else if(3==(null===(l=t.expertSelectionLibrary)||void 0===l?void 0:l.type))e.navigateTo({url:"/pages/roadhelp/index?forwardUserId="+t.article.userId});else if(1==(null===(u=t.expertSelectionLibrary)||void 0===u?void 0:u.type))e.navigateTo({url:"/pages/home/activityDetail/index?id="+f+"&forwardUserId="+t.article.userId});else if(4==(null===(d=t.expertSelectionLibrary)||void 0===d?void 0:d.type))e.navigateTo({url:"/pages/grouppurchase/detail?id="+f+"&forwardUserId="+t.article.userId});else if(5==(null===(p=t.expertSelectionLibrary)||void 0===p?void 0:p.type))e.navigateTo({url:"/pages/activity/activityRegistration/packagedetail?id="+f+"&forwardUserId="+t.article.userId});else if(6==(null===(h=t.expertSelectionLibrary)||void 0===h?void 0:h.type)){var m,v;e.navigateTo({url:"/pages/carShops/carList/index?id="+(null===(m=t.expertSelectionLibrary)||void 0===m?void 0:m.relatedId)+"&type=1&shopId="+(null===(v=t.expertSelectionLibrary)||void 0===v?void 0:v.shopId)})}},change:function(t){var i=this;this.isshowitem=!1,this.showcomment=!1,this.changid=this.dataList[t.detail.current].article.id,this.dataList.article=this.dataList[t.detail.current].comments,this.commentList=this.isplay=!1,e.createVideoContext("play"+this.swiperindex).stop(),this.swiperindex=t.detail.current,e.createVideoContext("play"+this.swiperindex).play(),t.detail.current/9%1===0&&this.$request.post("/coc-social/api/v2/article/ids",{id:this.endid}).then((function(e){i.endid=e.data[9].article.id,e.data.filter((function(e){i.dataList.push(e)}))}))}}};t.default=l}).call(this,i("543d")["default"])},"632f":function(e,t,i){"use strict";i.r(t);var n=i("5378"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a},8455:function(e,t,i){},"89c2":function(e,t,i){"use strict";var n=i("8455"),o=i.n(n);o.a},baf6:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}));var n={uIcon:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(i.bind(null,"0f14"))},uPopup:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(i.bind(null,"8add"))},uAvatar:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-avatar/u-avatar")]).then(i.bind(null,"d838"))},"u-Input":function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u--input/u--input")]).then(i.bind(null,"c00c"))},"u-Textarea":function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u--textarea/u--textarea")]).then(i.bind(null,"f44e"))},uUpload:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-upload/u-upload")]).then(i.bind(null,"9a59"))},uActionSheet:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-action-sheet/u-action-sheet")]).then(i.bind(null,"ab3c"))}},o=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.showcomment=!1},e.e1=function(t){e.showcommentpop=!0},e.e2=function(t){e.showreply=!1},e.e3=function(t){e.showcommentpop=!1},e.e4=function(t){e.showsheet=!1})},a=[]},dd74:function(e,t,i){"use strict";(function(e,t){var n=i("4ea4");i("76b1");n(i("66fd"));var o=n(i("f805"));e.__webpack_require_UNI_MP_PLUGIN__=i,t(o.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},f805:function(e,t,i){"use strict";i.r(t);var n=i("baf6"),o=i("632f");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("89c2");var s=i("f0c5"),r=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);t["default"]=r.exports}},[["dd74","common/runtime","common/vendor"]]]);